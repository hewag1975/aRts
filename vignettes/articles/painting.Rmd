---
title: "Create a painting from an image"
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE
    # , comment = "#>"
    , out.width = "100%"
)
```


## Example images

First load the required packages:

```{r pkg, message = FALSE}
library(stars)
library(sf)
library(aRts)
```

The package comes with a few example images which can be used for exploration. 

```{r img}
ifl = system.file(
    c("img/lake.jpg", "img/mountains.jpg")
    , package = "aRts"
)
ifl
```

The images are imported into R using `stars::read_stars()`. This is due to the 
fact that the `supercells()` function used to create the paintings requires an 
object of class `stars` (or alternatively `terra`).

```{r imp}
img = lapply(
    ifl
    , FUN = read_stars
)

img[[1]]

img[[2]]
```


## Create paintings

Create a painting using the default settings.

```{r}
ptg = lapply(
    img
    , FUN = painting
)

ptg[[1]]
class(ptg[[1]])
```

Plot original image and painting side by side.

```{r asp, include = FALSE}
ratio = lapply(img, FUN = \(i) dim(i)[2] / (2 * dim(i)[1]))
```

```{r lake, fig.asp = ratio[[1]]}
par(mfrow = c(1, 2))
plot(img[[1]], rgb = 1:3, main = "", reset = FALSE, useRaster = TRUE)
plot(ptg[[1]])
```

```{r mountains, fig.asp = ratio[[2]]}
par(mfrow = c(1, 2))
plot(img[[2]], rgb = 1:3, main = "", reset = FALSE, useRaster = TRUE)
plot(ptg[[2]])
```


## Export results

The `sf_paint` object is basically a spatial class with a number of polygons 
delineating areas of similar color compsition on the image. To save the paiting 
to disk, you can use the plot device and .

```{r exp, eval = FALSE}
jpeg(
    "~/lake_painting.jpg"
    , width = dim(img[[1]])[1]
    , height = dim(img[[1]])[2]
    , units = "px"
)
plot(ptg[[1]])
dev.off()
```

